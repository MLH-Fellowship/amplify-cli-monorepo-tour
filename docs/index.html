<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/amplify-cli-monorepo-tour/blog/rss.xml" title="Amplify CLI Monorepo Tour Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/amplify-cli-monorepo-tour/blog/atom.xml" title="Amplify CLI Monorepo Tour Blog Atom Feed"><title data-react-helmet="true">Amplify CLI | Amplify CLI Monorepo Tour</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Amplify CLI | Amplify CLI Monorepo Tour"><meta data-react-helmet="true" name="description" content="The Amplify Command Line Interface (CLI) monorepo tour is a guide for software developers by software developers. This guide aims to help new Amazon engineers and the huge awesome community of open source contributors to get started with the development and improvement of the Amplify CLI."><meta data-react-helmet="true" property="og:description" content="The Amplify Command Line Interface (CLI) monorepo tour is a guide for software developers by software developers. This guide aims to help new Amazon engineers and the huge awesome community of open source contributors to get started with the development and improvement of the Amplify CLI."><meta data-react-helmet="true" property="og:url" content="https://mlh-fellowship.github.io/amplify-cli-monorepo-tour/docs/"><link data-react-helmet="true" rel="shortcut icon" href="/amplify-cli-monorepo-tour/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://mlh-fellowship.github.io/amplify-cli-monorepo-tour/docs/"><link rel="stylesheet" href="/amplify-cli-monorepo-tour/styles.96e3f87d.css">
<link rel="preload" href="/amplify-cli-monorepo-tour/styles.da24d110.js" as="script">
<link rel="preload" href="/amplify-cli-monorepo-tour/runtime~main.70be01df.js" as="script">
<link rel="preload" href="/amplify-cli-monorepo-tour/main.7cafb81f.js" as="script">
<link rel="preload" href="/amplify-cli-monorepo-tour/1.8086ea6f.js" as="script">
<link rel="preload" href="/amplify-cli-monorepo-tour/34.32126f31.js" as="script">
<link rel="preload" href="/amplify-cli-monorepo-tour/35.e11efc0a.js" as="script">
<link rel="preload" href="/amplify-cli-monorepo-tour/935f2afb.38687bf8.js" as="script">
<link rel="preload" href="/amplify-cli-monorepo-tour/33.8fe77da3.js" as="script">
<link rel="preload" href="/amplify-cli-monorepo-tour/c377a04b.8ad2e9e7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/amplify-cli-monorepo-tour/"><img src="/amplify-cli-monorepo-tour/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/amplify-cli-monorepo-tour/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Amplify CLI Monorepo Tour</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/amplify-cli-monorepo-tour/docs/">Docs</a><a class="navbar__item navbar__link" href="/amplify-cli-monorepo-tour/blog/">Blogs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/MLH-Fellowship/amplify-cli-monorepo-tour" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">View on GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/amplify-cli-monorepo-tour/"><img src="/amplify-cli-monorepo-tour/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/amplify-cli-monorepo-tour/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Amplify CLI Monorepo Tour</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/amplify-cli-monorepo-tour/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/amplify-cli-monorepo-tour/blog/">Blogs</a></li><li class="menu__list-item"><a href="https://github.com/MLH-Fellowship/amplify-cli-monorepo-tour" target="_blank" rel="noopener noreferrer" class="menu__link">View on GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/amplify-cli-monorepo-tour/docs/">Amplify CLI</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">amplify-util-mock</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/amplify-cli-monorepo-tour/docs/amplify-util-mock/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/amplify-cli-monorepo-tour/docs/amplify-util-mock/commands">Commands</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">amplify-cli</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/amplify-cli-monorepo-tour/docs/amplify-cli/">Amplify CLI Package</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/amplify-cli-monorepo-tour/docs/amplify-cli/amplify-env">Amplify Multienv</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Amplify CLI</h1></header><div class="markdown"><p>The Amplify Command Line Interface (CLI) monorepo tour is a guide for software developers by software developers. This guide aims to help new Amazon engineers and the huge awesome community of open source contributors to get started with the development and improvement of the Amplify CLI.</p><p>The goal and objective of this guide is to reduce the time taken to get familiar with the code, architecture and configuration of the large number of packages in the Amplify CLI monorepo by explaining the magic happening under the hood when you run a Amplify CLI command on your terminal.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="pre-requisites"></a>Pre-requisites<a class="hash-link" href="#pre-requisites" title="Direct link to heading">#</a></h2><p>This guide assumes that you have followed the <a href="https://github.com/aws-amplify/amplify-cli/blob/master/CONTRIBUTING.md#local-environment-setup" target="_blank" rel="noopener noreferrer">local environment setup instructions</a> and you are ready with an instance of <code>amplify-dev</code>.</p><p>To verify run <code>amplify-dev --version</code> in your terminal.</p><p>Now open the <code>amplify-cli</code> project in your favourite IDE.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="structure"></a>Structure<a class="hash-link" href="#structure" title="Direct link to heading">#</a></h2><p>The Amplify CLI monorepo (multi-package repositories) has the following top level structure. This structure excludes common configuration files like <code>.gitignore</code>, markdown files and files under <code>files.exclude</code> in your project&#x27;s <code>.vscode/settings.json</code> so that we can focus on the main parts.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ .circleci</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ codecov.yml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ commitlint.config.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ cypress</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ lerna.json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ .lgtm.yml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ package.json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ packages</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ pkg</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ scripts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ tsconfig.base.json</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Let us explore the contents of the directories to understand different parts of the Amplify CLI.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="continuous-integration"></a>Continuous Integration<a class="hash-link" href="#continuous-integration" title="Direct link to heading">#</a></h3><p>Amplify CLI uses <a href="https://circleci.com" target="_blank" rel="noopener noreferrer">CircleCi</a> to automate the development process with continuous integration in their cloud.</p><p>Now go to the <code>.circleci</code> directory in your project.</p><p>You will see the following structure.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ amplify_init.exp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ amplify_init.sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ api.sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ auth.sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ aws_configure.exp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ aws.sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ config.base.yml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ config.yml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ delete_api.exp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ delete_api.sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ delete_auth.exp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ delete_auth.sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ enable_api.exp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ enable_auth.exp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ local_publish_helpers.sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â””â”€â”€ verdaccio.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This is a collection of <code>.sh</code> (shell scripts), <code>.exp</code> (expect scripts) and configuration files for circleci and Verdaccio (a simple, zero-config-required local private npm registry). Verdaccio uplinks the npmjs registry in the <code>verdaccio.yaml</code> file so that we can fetch packages from multiple sources in one single project.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="expect-and-shell-scripts"></a>Expect and Shell scripts<a class="hash-link" href="#expect-and-shell-scripts" title="Direct link to heading">#</a></h4><ul><li><p>Expect scripts talk with interactive programs or scripts that require user interaction.</p></li><li><p>It works by expecting input, then the Expect script will send the response without any user interaction with the help of the following commands.</p></li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">spawn    Starts a script or a program.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">expect   Waits for program output.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">send     Sends a reply to your program.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">interact Allows you to interact with your program.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Example</p><ul><li><p>Go to <code>amplify_init.exp</code> script and observe line 3 - <code>spawn ./.circleci/amplify_init.sh $repo</code>.</p></li><li><p>All expect scripts in the folder follow a similar pattern of using <code>spawn</code> command to run the relevant <code>.sh</code> scripts in the folder.</p></li><li><p>Then <code>expect</code> and <code>send</code> commands are used in combination in the expect script.</p></li><li><p>All these scripts are called from the CircleCI</p></li></ul><p>CircleCI believes in configuration as code. Your entire continuous integration and deployment process is orchestrated through a single config file as mentioned below.</p><p>Now open the <code>config.base.yml</code> file.</p><p>This file is a collection of workflows, jobs and steps. Workflows are responsible for orchestrating multiple jobs. Jobs are responsible for running a series of steps that perform commands. Steps run commands (such as installing dependencies or running tests) and shell scripts to do the work required for our project.</p><p>YAML allows declaring a node as an anchor. This means this node will be referred to somewhere later in the YAML.</p><p>We can use an anchor at the beginning of our config file to set these lines as our default for jobs.</p><p><img src="/amplify-cli-monorepo-tour/assets/images/anchor-cd100281f4d7c2bc914a5f14270dbf19.png"></p><p>Then we use an alias with each job to write less lines.</p><p><img src="data:image/png;base64,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"></p><p>This way we didnâ€™t just reduce the number of lines. Weâ€™ve made it easier to maintain the YAML file.</p><p>This is followed by a set of reusable commands like <code>update_os_packages</code> which can be called as steps in any job(s) in this <code>config</code>.</p><p>This is followed by a set of jobs which are the building blocks of our CI/CD pipeline. Each job must declare an executor. In our case most jobs use the docker container as executor which is defined as an anchor at the beginning of the <code>config</code> file.</p><p><img src="/amplify-cli-monorepo-tour/assets/images/job-988c3d35c688846d7a1c023c0d9cf110.png"></p><p>Each separate job defined within our <code>config</code> will run in a unique executor. The Primary container is defined by the first image listed in the <code>config</code> file. This is where commands are executed. The Docker executor spins up a container with a Docker image.</p><p><img src="data:image/png;base64,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"></p><p>Workflows define a list of jobs and their run order. We have 2 workflows for our Amplify CLI project:-</p><ul><li><p><code>nightly_console_integration_tests</code> - This workflow runs jobs only on the <code>master</code> branch on a schedule using <code>cron</code>. It builds the project, publishes it to local registry and then runs amplify console integration tests.</p></li><li><p><code>build_test_deploy</code> - This workflow is self defining and runs a large set of jobs while defining run order, dependencies and approval to eventually make a new github release.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="scripts"></a>Scripts<a class="hash-link" href="#scripts" title="Direct link to heading">#</a></h3><p>The <code>scripts</code> directory is a combination of JavaScript and TypeScript files.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ constants.ts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ echo-current-cli-version.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ github-common.ts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ github-prerelease.ts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ github-release.ts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ link-bin.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ split-e2e-tests.ts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â””â”€â”€ unified-changelog.ts</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The <code>github-common.ts</code> has constants and utils shared by <code>github-prerelease.ts</code> and <code>github-release.ts</code>.</p><p>These scripts are used in various jobs in the CircleCI <code>config.base.yml</code> file.</p><p>The <code>unified-changelog.ts</code> script is used to generate a unified changelog and the <code>echo-current-cli-version.js</code> script is used to save new Amplify GitHub tag under the <code>publish_to_local_registry</code> job in CircleCI.</p><p>The <code>github-prerelease.ts</code> script is used to publish Amplify CLI GitHub prerelease under the <code>github_prerelease</code> job in CircleCI.</p><p>The <code>github-release.ts</code> script is used to publish Amplify CLI GitHub release under the <code>github_release</code> job in CircleCI.</p><p>The <code>split-e2e-tests.ts</code> is an interesting script which defines concurrency (no. of parallel jobs allowed) and different AWS regions which are used to run the tests. It has a long array of test suites sorted according to their runtime and utilities like <code>sortTestsBasedOnTime</code> help to achieve the same.</p><p>The execution of the <code>split-e2e-tests.ts</code> script starts from the <a href="https://github.com/aws-amplify/amplify-cli/blob/f3b1d1d66fa2705a6ee73b5732c3919cd77632f7/scripts/split-e2e-tests.ts#L306" target="_blank" rel="noopener noreferrer">main function</a>.</p><p>The initial step is to load the <code>config.base.yml</code> file using the <code>loadConfig()</code> function.</p><p>Then the <code>splitTests()</code> function takes the CircleCI config and converts each test inside that job into a separate job.</p><p>The last step is to generate a new <code>config.yml</code> file using the <code>saveConfig()</code> function.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cypress"></a>Cypress<a class="hash-link" href="#cypress" title="Direct link to heading">#</a></h3><p>The <code>cypress</code> directory mainly has 2 integration tests for <code>auth</code> and <code>api</code>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ fixtures</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”‚Â Â  â””â”€â”€ example.json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ integration</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”‚Â Â  â”œâ”€â”€ api_spec.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”‚Â Â  â””â”€â”€ auth_spec.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”œâ”€â”€ plugins</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â”‚Â Â  â””â”€â”€ index.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">â””â”€â”€ support</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    â”œâ”€â”€ commands.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    â””â”€â”€ index.js</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The <code>auth_spec.js</code> file tests the withAuthenticator Sign In functionality.</p><p>The <code>api_spec.js</code> file tests the API functionality by adding and requesting data from DynamoDB.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/MLH-Fellowship/amplify-cli-monorepo-tour/edit/main/docs/index.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/amplify-cli-monorepo-tour/docs/amplify-util-mock/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Amplify CLI Mocking Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pre-requisites" class="table-of-contents__link">Pre-requisites</a></li><li><a href="#structure" class="table-of-contents__link">Structure</a><ul><li><a href="#continuous-integration" class="table-of-contents__link">Continuous Integration</a></li><li><a href="#scripts" class="table-of-contents__link">Scripts</a></li><li><a href="#cypress" class="table-of-contents__link">Cypress</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/amplify-cli-monorepo-tour/docs/">Amplify CLI</a></li><li class="footer__item"><a class="footer__link-item" href="/amplify-cli-monorepo-tour/docs/amplify-util-mock/">amplify-util-mock</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/aws-amplify" target="_blank" rel="noopener noreferrer" class="footer__link-item">Official GitHub</a></li><li class="footer__item"><a href="https://discord.gg/amplify" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/AWSAmplify" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/MLH-Fellowship/amplify-cli-monorepo-tour" target="_blank" rel="noopener noreferrer" class="footer__link-item">View on GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://aws.amazon.com/amplify/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_31Aa"><img class="footer__logo" alt="AWS Amplify Logo" src="/amplify-cli-monorepo-tour/img/logo.svg"></a></div><div class="footer__copyright">Copyright Â© 2021 MLH-Fellowship. Built with Docusaurus.</div></div></div></footer></div>
<script src="/amplify-cli-monorepo-tour/styles.da24d110.js"></script>
<script src="/amplify-cli-monorepo-tour/runtime~main.70be01df.js"></script>
<script src="/amplify-cli-monorepo-tour/main.7cafb81f.js"></script>
<script src="/amplify-cli-monorepo-tour/1.8086ea6f.js"></script>
<script src="/amplify-cli-monorepo-tour/34.32126f31.js"></script>
<script src="/amplify-cli-monorepo-tour/35.e11efc0a.js"></script>
<script src="/amplify-cli-monorepo-tour/935f2afb.38687bf8.js"></script>
<script src="/amplify-cli-monorepo-tour/33.8fe77da3.js"></script>
<script src="/amplify-cli-monorepo-tour/c377a04b.8ad2e9e7.js"></script>
</body>
</html>